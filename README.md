# お知らせ管理アプリケーション

重要なお知らせを PDF と音声で投稿し、一覧ページから確認できる PHP アプリケーションです。投稿データは MySQL データベースで管理され、音声ファイルのパスも保存されます。phpMyAdmin からテーブルを確認・編集できます。

## 主な機能

- 投稿フォームからタイトル・PDF・音声を登録
- `uploads/` ディレクトリにファイルを保存し、パスをデータベースへ登録
- 一覧ページ（`form.php`）で最新投稿を取得して表示
- 一覧の音声アイコンからブラウザ内で音声を再生

## 必要要件

- PHP 8.1 以降
- MySQL 5.7 / 8 互換 DB（MariaDB 10.5+ を含む）
- phpMyAdmin（データベースのGUI管理ツールとして任意）
- Composer など追加の依存はありません

## セットアップ手順

1. **リポジトリを取得**
   ```bash
   git clone &lt;repo-url&gt;
   cd team_Butouha
   ```

2. **データベースを作成**（phpMyAdmin または MySQL クライアント）
   - phpMyAdmin でログインし「インポート」を選択、`database/schema.sql` を読み込む。
   - 直接 MySQL を使用する場合は以下を実行:
     ```sql
     SOURCE database/schema.sql;
     ```
   - これにより `butouha_app` データベースと `posts` テーブルが作成されます。

3. **接続情報を設定**
   - `config.php` は環境変数 `DB_HOST` / `DB_NAME` / `DB_USER` / `DB_PASS` を参照します。
   - もしくは `config.php` 内のデフォルト値（`127.0.0.1`, `butouha_app`, `root`, 空パスワード）を環境に合わせて編集してください。

4. **ファイル保存ディレクトリを準備**
   - `uploads/` ディレクトリは投稿時に自動作成されます。Web サーバーから書き込みできるように権限を設定してください。

5. **ローカルサーバーを起動**（例）
   ```bash
   php -S 127.0.0.1:8000
   ```
   ブラウザで `http://127.0.0.1:8000/index.php` へアクセスします。

## phpMyAdmin での管理

- `posts` テーブルには以下の列があります：
  | 列名 | 説明 |
  | ---- | ---- |
  | `id` | 自動採番の主キー |
  | `title` | 投稿タイトル |
  | `pdf_path` | PDF ファイルの相対パス（例：`uploads/document_20240101010101_xxxx.pdf`） |
  | `audio_path` | 音声ファイルの相対パス（例：`uploads/voice_20240101010101_xxxx.webm`） |
  | `created_at` | 投稿日時（自動設定） |
- phpMyAdmin 上で投稿を編集・削除すると一覧表示にも即時反映されます。

## 動作確認

1. `style.html` からタイトルと PDF を入力し、音声を録音して投稿します。
2. `upload.php` の完了画面でアップロード結果とデータベース登録状態を確認します。
3. `form.php` で投稿が一覧に表示され、音声アイコンから再生できることを確認します。

## 補足

- データベースエラーが発生した場合は `upload.php` に警告が表示されます。Web サーバーのログを参照し、`config.php` の接続情報を確認してください。
- 投稿一覧は `posts.php` を通じて JSON 形式で取得します。外部システムからの連携にも再利用できます。
